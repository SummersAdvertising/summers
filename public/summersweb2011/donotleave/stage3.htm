<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
<title>慰留大作戰！Visual Studio 2010 + MSDN為您留住所有開發人才</title>
<link href="framestyle.css" rel="stylesheet" type="text/css" />
<link href="jquery.simpledialog.0.1.css" rel="stylesheet" type="text/css"/>
<style type="text/css">
/* disabled 也不變色 */
.ui-state-disabled, .ui-widget-content .ui-state-disabled, .ui-widget-header .ui-state-disabled { opacity:1; }
/* 對話框 */
.sd_container { background-color:transparent; border:0px solid #CCCCCC; font-family:arial,helvetica,sans-serif; margin:0; padding:10px; position:absolute; text-align:center; }
#icon-wrong  { display: none; top: 0px; left: 0px; z-index:4; position: absolute; }
#dialog-wrong { display: none; cursor:pointer; position: absolute; top: 0px; left:0px; width:421px; height:295px; }
#dialog-right { display: none; cursor:pointer; position: absolute; top: 0px; left:0px; width:455px; height:291px; }
.cursor-move { cursor: move; } 
</style>
<script type="text/javascript">
if (document.referrer=='') { alert('請勿作弊! 重頭開始。'); location.href = 'stage1.htm'; }
</script>
<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
<script type="text/javascript"src="jquery-ui-1.8.5.custom.min.js"></script>
<script type="text/javascript"src="jquery.simpledialog.0.1.min.js"></script>
<!-- script type="text/javascript" src="jquery.flashSound-1.2.min.js"></script -->
<script type="text/javascript">
var reId = /^\D+(\d+)$/; //ID尾數字
var iDrag, iDrop;
var pos = [];
var iOffset = 8; // ID 起始值
var iMaxScore = 3; //幾個點
$(document).ready(function() {

  //對錯對話框
  $('#simpledialog-wrong,#simpledialog-right').simpleDialog({showCloseLabel: false,showCaption: false, close:unDrag });

  //設定可移元素  ***
  $("#choose8,#choose9,#choose10").addClass('cursor-move').draggable( {containment:'#bigbody',revert: true} );
  $('#bigbody').disableSelection();
  
  //記憶位置 ***
  for(var i=0;i<iMaxScore;i++) pos[i] = $("#choose"+(i+iOffset)+":first").position();

  //設定可放區 ***
  $("#listbox8,#listbox9,#listbox10").droppable({
    drop: function(e,ui) {
      iDrag = reId.test(ui.draggable.attr('id'))?RegExp.$1:0; //取拖ID名尾數字
      iDrop = reId.test($(this).attr('id'))?RegExp.$1:0;  //取放ID名尾數字
      
      if(iDrag==0||iDrop==0) { alert('Error!'); return; }

      var p = $("#listbox"+iDrop).position(); // 放區正確位置
      
      $(ui.draggable).draggable("option","revert",false).animate({left:p.left+4,top:p.top+4},"fast","swing", function() { //把抓進來的移到正確放上的位置
        $("#listbox"+iDrop+" > img").attr('src','images/list.png'); // 放區背景正常

        if( (iDrag==8 && iDrop==8) || (iDrag==9 && iDrop==9) || (iDrag==10 && iDrop==10) ) { //正確 ***
          //$.flashSound.play('bingo'); //聲音
          $("#listbox"+iDrop).droppable("disable"); // 也不能再抓進來
          $(ui.draggable).removeClass('cursor-move').draggable("disable"); // 不能再抓走
          $('#bigbody').append($('<div style="position:absolute;z-index:4;left:'+pos[iDrag-iOffset].left+'px;top:'+pos[iDrag-iOffset].top+'px"><img src="images/btn_right.png" width="60" height="49"></div>')); //打勾 ***
          calScore();
        }
        else { //錯誤
          // $.flashSound.play('wrong'); //聲音
          $("#icon-wrong").css({left:pos[iDrag-iOffset].left,top:pos[iDrag-iOffset].top}).show('slow'); //打叉 ***
          $('#simpledialog-wrong').click();
        }
        
      });
    },
    over: function(event, ui) { iDrop = reId.test($(this).attr('id'))?RegExp.$1:0; $("#listbox"+iDrop+" > img").attr('src','images/list2.png'); }, // 放區背景亮
    out: function(event, ui) { iDrop = reId.test($(this).attr('id'))?RegExp.$1:0; $("#listbox"+iDrop+" > img").attr('src','images/list.png'); }, // 放區背景正常
  });

  //聲音載入
  //$.flashSound('sound-bingo.mp3', {id: 'bingo'});
  //$.flashSound('sound-wrong.mp3', {id: 'wrong'});
  
});

function closeWrong() {
  unDrag();
  $.simpleDialog.close();
}
function unDrag() {
  $("#icon-wrong").hide(); //取消打叉
  $('#choose'+iDrag).animate({left:pos[iDrag-iOffset].left,top:pos[iDrag-iOffset].top}, "slow").draggable("option","revert",true); //歸位 ***
}

var iScore = 0;
function calScore() {
  if(++iScore==iMaxScore) { // 三個正確 ***
    $('#simpledialog-right').click();
  }
}

</script>
</head>

<body>

<div id="bigbody">
<div id="ribbon" style="position:absolute;z-index:9999;top:0;left:180px"><img src="images/ribbon.png" width="241" height="47"></div>
<div id="bg"><img src="images/gamebg_3.jpg" width="960" height="800"></div>
<div id="mslogo"><img src="images/mslogo.png" width="142" height="23"></div>
<div id="goindex"><a href="default.htm"><img src="images/backindex.png" width="39" height="34" border="0"></a></div>
<div id="gamelogo"><img src="images/gamelogo.png" width="387" height="221"></div>
<div id="question3"><img src="images/gametable3.png" width="447" height="285" border="0" usemap="#Map">
<map name="Map">
  <area shape="rect" coords="118,52,426,98" href="problembye8.htm" target="_blank">
<area shape="rect" coords="90,118,421,176" href="problembye9.htm" target="_blank">
<area shape="rect" coords="105,185,413,236" href="problembye10.htm" target="_blank">
</map></div>


<div id="choose8"><img src="images/choosebtn1.png" width="60" height="49"></div>
<div id="choose9"><img src="images/choosebtn2.png" width="60" height="49"></div>
<div id="choose10"><img src="images/choosebtn3.png" width="60" height="49"></div>

<div id="employee3"><img src="images/employee3.png" width="516" height="377"></div>


<div id="letterbox10"><img src="images/letter10.png" width="207" height="236"></div>
<div id="listbox10"><img src="images/list.png" width="64" height="56"></div>

<div id="letterbox9"><img src="images/letter9.png" width="222" height="255"></div>
<div id="listbox9"><img src="images/list.png" width="64" height="56"></div>

<div id="letterbox8"><img src="images/letter8.png" width="205" height="241"></div>
<div id="listbox8"><img src="images/list.png" width="64" height="56"></div>

<div id="copy_right">
  <table width="700" height="29" border="0" cellpadding="0" cellspacing="0">
    <tr>
      <td width="700"><div align="center"><span class="gray_11px">© 2011 Microsoft Corporation. 著作權所有，並保留一切權利。台灣微軟對本活動保有異動權。　<a href="http://www.microsoft.com/taiwan/misc/cpyright.htm" target="_blank">使用規定</a> | <a href="http://support.microsoft.com/contactus/?ln=zh-tw&ws=taiwan" target="_blank">與我們聯絡</a> | <a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/zh-tw.mspx" target="_blank">商標</a> | <a href="http://go.microsoft.com/fwlink/?LinkId=81184&clcid=0x404" target="_blank">隱私權聲明</a></span></div></td>
    </tr>
  </table>
</div>

<div id="people1"><img src="images/peoplenumber3.png" width="211" height="71"></div>

<div id="icon-wrong"><img src="images/btn_wrong.png" width="60" height="49"></div>
</div>

<a href="#" rel="dialog-wrong" id="simpledialog-wrong" style="display:none"></a>
<a href="#" rel="dialog-right" id="simpledialog-right" style="display:none"></a>
<div id="dialog-wrong"><img style="cursor:pointer" src="images/wrongimage.png" onclick="closeWrong()" /></div>
<div id="dialog-right"><a href="stage4.htm"><img style="cursor:pointer" src="images/allrightimage.png" border="0" /></a></div>

</body>

</html>
